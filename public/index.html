<!DOCTYPE html> 
<html> 
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>笑笑爸爸的微博</title> 
	<link rel="stylesheet" href="//code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />
	<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js"></script>
	<script src=" http://tjs.sjs.sinajs.cn/open/api/js/wb.js?appkey=1909920597" type="text/javascript" charset="utf-8"></script>
	<style>
	li{
		list-style:none;
		line-height:1.4;
	}
	ul{
		margin:0;
		padding:0;
	}
	.tweetList{
		border-bottom:1px solid #333;
		padding:10px 0;
		overflow:hidden;
		color:#534d35;
	}
	.retweet{
		margin:10px 0;
		overflow:hidden;
		padding:10px;
		background:rgba(231,230,216,.6);
		border:#dbdbdb 1px solid;
		-webkit-border-radius:4px;
	}
	.userProfileImg{
		float:left;
		margin-right:20px;
		border:2px solid #fff;
		-webkit-border-radius:4px;
	}
	.tweetContent{
		margin-left:75px;
	}
	.ui-content{
		background:#d1d1d1;
	}
	.screen_name{
		padding-bottom:10px;
	}
	@media only screen and (-webkit-min-device-pixel-ratio: 2){
		
	}
	</style>
</head> 
<body>             


	<!-- Start of first page: #one -->
	<div data-role="page" id="one">

		<div data-role="header">
			<ul>
				<li>我的微博</li>
				<li>消息</li>
				<li>我的微博</li>
				<li>我的微博</li>
			</ul>
		</div><!-- /header -->

		<div data-role="content" >	
			<!-- <a href="https://api.weibo.com/oauth2/authorize?client_id=1909920597&response_type=token&redirect_uri=http://jason.me:3001/">connect weibo</a> -->
			
			<ul class="timeLine" id="homeTimeLine">
				
			</ul>
			
			
			<p><a href="#two" data-role="button">Show page "two"</a></p>	
			<p><a href="#popup"data-role="button" data-rel="dialog" data-transition="pop">Show page "popup" (as a dialog)</a></p>
		</div><!-- /content -->

		<div data-role="footer" data-theme="d">
			<h4>Page Footer</h4>
		</div><!-- /footer -->
	</div><!-- /page one -->


	<!-- Start of second page: #two -->
	<div data-role="page" id="two">

		<div data-role="header">
			<h1>Two</h1>
		</div><!-- /header -->

		<div data-role="content" data-theme="a">
			<ul class="timeLine" id="ids">
				
			</ul>
		</div>
			

		<div data-role="footer">
			<h4>Page Footer</h4>
		</div><!-- /footer -->
	</div><!-- /page two -->


	<!-- Start of third page: #popup -->
	<div data-role="page" id="popup">

		<div data-role="header" data-theme="e">
			<h1>Dialog</h1>
		</div><!-- /header -->

		<div data-role="content" data-theme="d">
			
		</div>
			

		<div data-role="footer">
			<h4>Page Footer</h4>
		</div><!-- /footer -->
	</div><!-- /page popup -->

<script>
function replaceReg(reg,str){
  return str.replace(reg,function(m){return '<a href="'+m+'">'+m+'</a>';}) 
 }

	var xiaoxiaoWB = {
			timeline : function(json,targetId,countNumber,screenName,method){
			WB2.anyWhere(function(W){
			W.parseCMD(json, function(sResult, bStatus){
						$(targetId).empty();
						for(i=0;i<sResult.length;i++){
							
							if( sResult[i].thumbnail_pic ){
								$(targetId).append("<li class='tweetList  tweetList" + i + "' data-role='listview'>" + "<img class='userProfileImg' src=" +sResult[i].user.profile_image_url+ " /><div class='tweetContent'><a href='#two' class='screen_name'>" + sResult[i].user.screen_name + "</a><br /><span class='tweetText'>" + sResult[i].text + "</span><br />"+ "<a href=" +sResult[i].original_pic+ "><img class='thumbnail_pic' src="+sResult[i].thumbnail_pic+" /></a>" + "</div><li>");
								}else{
									$(targetId).append("<li class='tweetList  tweetList" + i + "' data-role='listview'>" + "<img class='userProfileImg' src=" +sResult[i].user.profile_image_url+ " /><div class='tweetContent'><a href='#two' class='screen_name'>" + sResult[i].user.screen_name+ "</a><br /><span class='tweetText'>"+sResult[i].text + "</span></div><li>");
								};
								if( sResult[i].retweeted_status ){
									$(targetId+" .tweetList"+i +" .tweetContent").append("<li class='retweet'><a href='#two' class='screen_name'>" + sResult[i].retweeted_status.user.screen_name+ "</a><br /><span class='tweetText'>"+sResult[i].retweeted_status.text  + "</span><li>");
								}else if( sResult[i].retweeted_status && sResult[i].retweeted_status.thumbnail_pic ){
									$(targetId+" .tweetList"+i+" .tweetContent").append("<li class='retweet'><a href='#two' class='screen_name'>" + sResult[i].retweeted_status.user.screen_name+ "</a><br /><span class='tweetText'>"+sResult[i].retweeted_status.text + "</span><br />"+ "<a href=" +sResult[i].retweeted_status.original_pic+"<img src="+sResult[i].retweeted_status.thumbnail_pic+" /></a>" + "<li>");
								}
							
						}//end for
						var regexp = new RegExp("(http[s]{0,1}|ftp)://[a-zA-Z0-9\\.\\-]+\\.([a-zA-Z]{2,4})(:\\d+)?(/[a-zA-Z0-9\\.\\-~!@#$%^&amp;*+?:_/=<>]*)?", "gi");
						$('.tweetText').each(function(){
							var str = $(this).text();
							$(this).html(replaceReg(regexp,str));
						});
			},{
				count:countNumber,
				screen_name: screenName
			},{
			    method: method
			});
			});
		}
		
		
	}//end xiaoxiaoWB
	
	xiaoxiaoWB.timeline('/statuses/home_timeline.json','#homeTimeLine','100','','post');

	
	
	$('.screen_name').live('tap', function(){
		$('#ids').empty();
		xiaoxiaoWB.timeline('/statuses/user_timeline/ids.json','#ids','100',$(this).text(),'get');
	});
	
	
	
	
	
</script>

</body>
</html>